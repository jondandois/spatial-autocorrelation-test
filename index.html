<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <style>
      #main {
      }
      #myCanvas {
        border: 1px solid gray;
        width: 600px;
        height: 400px;
      }
      .left {
        padding-right: 10px;
        float: left;
      }
      .right {
        float: left;
      }
      #console {
        height: 400px;
        font-family: 'Dosis', Helvetica, sans-serif;
        font-size: 1em;
      }
      button {
        float: right;
      }

    </style>
  </head>
  <body>
    <div class="main">
      <div class="left">
        <canvas id="myCanvas"></canvas>
        <div class="bottom">
          <span>
            <a href="https://github.com/jondandois/spatial-autocorrelation-test">
              Check out this project on Github
            </a>
            Jonathan Dandois
          </span>
        </div>
      </div>
      <div class="right">
        <textarea name="console" id="console" cols="30" rows="10"></textarea>
        <button id="dice" onClick="drawRandomPoint()">Random Point</button>
        <button onClick="randomPoints()">100 Random Points</button>
        <button onClick="randomCluster()">Random Cluster</button>
      </div>
    </div>

    <script>
      var canvas = document.getElementById("myCanvas");
      var canvasWidth = canvas.width;
      var canvasHeight = canvas.height;
      var ctx = canvas.getContext("2d");

      const colors = ["red", "orange", "yellow", "green", "blue","purple"];
      function getColor(){
        return colors[d6()-1];
      }

      function textConsole(text) {
        var textArea = document.getElementById("console");
        textArea.innerHTML = textArea.innerHTML + text;
        textArea.scrollTop = textArea.scrollHeight;
      }

      var d3 = dN(3);
      var d6 = dN(6);


      function drawRandomPoint() {
        var point = randomPoint();
        var color = getColor();
        var size = d3();
        textConsole(`${point.x}, ${point.y}, ${color}, ${size}\n`)
        drawPoint(point.x, point.y, color, size, ctx);
      }

      function randomCluster() {
        var center = randomPoint();
        for (var i = 100; i >= 0; i--) {
          var radius = getRandomArbitrary(1, 10);
          var angle = Math.random()*Math.PI*2;
          var x_diff = Math.cos(angle)*radius;
          var y_diff = Math.sin(angle)*radius;
          var x = Math.floor(center.x + x_diff);
          var y = Math.floor(center.y + y_diff);
          var color = getColor();
          var size = d3();
          textConsole(`${x}, ${y}, ${color}, ${size}\n`)
          drawPoint(x, y, color, size, ctx);
        }
      }

      function getRandomArbitrary(min, max) {
        return Math.floor(Math.random() * (max - min) + min);
      }

      function randomBias(low, high) {
        var r = Math.random();    // random between 0 and 1
        var r = Math.pow(r, Math.random());
        r -= Math.random();
        return Math.floor(low + (high - low) * r);
      }

      function dNBias(n) {
        return function(){
          return randomBias(1, n+1);
        }
      }

      function dN(n) {
        return function(){
          return getRandomArbitrary(1, n+1);
        }
      }

      function drawPoint(x, y, color, size, canvas){
        canvas.fillStyle = color;
        canvas.fillRect(x,y,size,size);
      }

      function randomPoint() {
        var x = getRandomArbitrary(0, canvasWidth);
        var y = getRandomArbitrary(0, canvasHeight);
        return {x: x, y: y}
      }
      function randomPoints() {
        for (var i = 100; i >= 0; i--) {
          drawRandomPoint();
        }
      }

    </script>

  </body>
</html>
